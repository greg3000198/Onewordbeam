<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OneWordBeam - Your Daily Light</title>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#667eea">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: white;
            overflow-x: hidden;
        }

        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            max-width: 500px;
            margin: 0 auto;
            width: 100%;
        }

        .logo {
            font-size: 1.3rem;
            font-weight: 600;
            letter-spacing: 2px;
            margin-bottom: 1rem;
            opacity: 0;
            animation: fadeIn 1s ease forwards;
        }

        .time-indicator {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 2rem;
            opacity: 0;
            animation: fadeIn 1s ease 0.2s forwards;
        }

        .word-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 3rem 2rem;
            margin-bottom: 2rem;
            width: 100%;
            text-align: center;
            opacity: 0;
            animation: fadeInUp 1s ease 0.3s forwards;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .daily-word {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            letter-spacing: 2px;
        }

        .word-description {
            font-size: 1rem;
            opacity: 0.9;
            line-height: 1.6;
        }

        .premium-section {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            width: 100%;
            opacity: 0;
            animation: fadeInUp 1s ease 0.5s forwards;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .premium-badge {
            display: inline-block;
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 1px;
            margin-bottom: 1rem;
            color: #333;
        }

        .premium-advice {
            font-size: 1.05rem;
            line-height: 1.8;
            margin-bottom: 1rem;
        }

        .locked-content {
            filter: blur(5px);
            user-select: none;
            margin-bottom: 1rem;
        }

        .unlock-btn {
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            color: #333;
            border: none;
            padding: 1rem 2rem;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
            width: 100%;
        }

        .unlock-btn:hover {
            transform: scale(1.05);
        }

        .evening-locked {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            width: 100%;
            text-align: center;
            opacity: 0;
            animation: fadeInUp 1s ease 0.7s forwards;
        }

        .evening-locked-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .evening-locked-text {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 1rem;
        }

        .stats {
            display: flex;
            gap: 2rem;
            margin-bottom: 2rem;
            opacity: 0;
            animation: fadeInUp 1s ease 0.9s forwards;
        }

        .stat {
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .share-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 0.8rem 2rem;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            opacity: 0;
            animation: fadeInUp 1s ease 1.1s forwards;
        }

        .share-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .premium-content {
            display: none;
        }

        .premium-content.active {
            display: block;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            color: #333;
            padding: 2rem;
            border-radius: 20px;
            max-width: 400px;
            width: 100%;
            text-align: center;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: #667eea;
        }

        .modal-text {
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .modal-features {
            text-align: left;
            margin-bottom: 1.5rem;
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 10px;
        }

        .modal-features li {
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .pricing {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1.5rem;
        }

        .price-options {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .price-option {
            flex: 1;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .price-option:hover {
            border-color: #667eea;
            background: #f9f9f9;
        }

        .price-option.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .price {
            font-size: 1.5rem;
            font-weight: 700;
            color: #667eea;
        }

        .price-period {
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .price-savings {
            font-size: 0.85rem;
            color: #4caf50;
            font-weight: 600;
            margin-top: 0.3rem;
        }

        .modal-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-bottom: 0.5rem;
        }

        .close-modal {
            background: transparent;
            color: #999;
            border: none;
            padding: 0.5rem;
            cursor: pointer;
            font-size: 0.9rem;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
            from {
                transform: translateY(20px);
            }
        }

        @media (max-width: 480px) {
            .daily-word {
                font-size: 2.5rem;
            }
            .container {
                padding: 1rem;
            }
            .price-options {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">OneWordBeam ‚ú®</div>
        <div class="time-indicator" id="timeIndicator">‚òÄÔ∏è Buongiorno</div>

        <div class="word-container">
            <div class="daily-word" id="dailyWord">ENERGIA</div>
            <div class="word-description" id="wordDescription">
                Oggi porta energia in tutto ci√≤ che fai. L'energia attrae opportunit√†.
            </div>
        </div>

        <div class="premium-section">
            <span class="premium-badge">‚ú® PREMIUM</span>
            
            <div id="lockedContent" class="locked-content">
                <div class="premium-advice">
                    üí° Appena sveglio, bevi 1 bicchiere d'acqua tiepida con limone...
                </div>
            </div>

            <button class="unlock-btn" id="unlockBtn">
                Sblocca 2 momenti al giorno per 1‚Ç¨/mese
            </button>

            <div class="premium-content" id="premiumContent">
                <div class="premium-advice" id="premiumAdvice">
                    <strong>üí° Consiglio:</strong><br><br>
                    Appena sveglio, bevi 1 bicchiere d'acqua tiepida con limone.
                </div>
            </div>
        </div>

        <div class="evening-locked" id="eveningSection" style="display: none;">
            <div class="evening-locked-icon">üåô</div>
            <div class="evening-locked-text">
                La parola della sera si sblocca alle 20:00 con Premium
            </div>
            <small style="opacity: 0.7;">Ricevi un secondo momento di ispirazione prima di dormire</small>
        </div>

        <div class="stats">
            <div class="stat">
                <span class="stat-number" id="streak">1</span>
                <span class="stat-label">Giorni</span>
            </div>
            <div class="stat">
                <span class="stat-number">üî•</span>
                <span class="stat-label">Streak</span>
            </div>
        </div>

        <button class="share-btn" id="shareBtn">Condividi la parola</button>
    </div>

    <div class="modal" id="premiumModal">
        <div class="modal-content">
            <div class="modal-title">Sblocca 2 momenti quotidiani</div>
            <div class="modal-text">
                Trasforma mattino e sera in rituali di crescita personale.
            </div>
            <div class="modal-features">
                <strong>Con Premium ricevi:</strong>
                <ul style="margin-top: 0.5rem;">
                    <li>‚òÄÔ∏è <strong>Parola mattutina</strong> + consiglio pratico (8:00)</li>
                    <li>üåô <strong>Parola serale</strong> + consiglio rilassante (20:00)</li>
                    <li>üí° Consigli su alimentazione, benessere, sonno</li>
                    <li>üìä Statistiche avanzate</li>
                </ul>
            </div>
            <div class="pricing">
                <div class="price-options">
                    <div class="price-option selected" id="monthlyOption" data-plan="monthly">
                        <div class="price">1‚Ç¨</div>
                        <div class="price-period">/mese</div>
                    </div>
                    <div class="price-option" id="yearlyOption" data-plan="yearly">
                        <div class="price">15‚Ç¨</div>
                        <div class="price-period">/anno</div>
                        <div class="price-savings">Risparmi 20%</div>
                    </div>
                </div>
            </div>
            <button class="modal-btn" id="subscribeBtn">Continua al pagamento</button>
            <button class="close-modal" id="closeModal">Continua gratis (solo mattino)</button>
        </div>
    </div>

    <script>
        // ========== CONFIGURAZIONE GOOGLE PLAY BILLING ==========
        const PLAY_PRODUCTS = {
            monthly: 'premium_monthly',
            yearly: 'premium_yearly'
        };

        // ========== DATABASE CONTENUTI ==========
        const dailyContent = [
          {
            morning: {
              word: "ENERGIA",
              desc: "Oggi porta energia in tutto ci√≤ che fai. L'energia attrae opportunit√†.",
              premium: "Appena sveglio, bevi 1 bicchiere d'acqua tiepida con limone. Reidrata dopo il digiuno notturno e attiva la digestione. Aspetta 15 minuti prima del caff√® per evitare picchi di cortisolo."
            },
            evening: {
              word: "QUIETE",
              desc: "La sera √® per rilasciare. Lascia andare ci√≤ che non ti serve pi√π.",
              premium: "Spegni tutti gli schermi 1 ora prima di dormire. Leggi 10 pagine di un libro cartaceo. La luce blu riduce melatonina del 50%, il libro cartaceo la favorisce."
            }
          },
          {
            morning: {
              word: "FOCUS",
              desc: "Concentrati su ci√≤ che conta davvero. Il resto √® rumore.",
              premium: "Inizia la giornata con la 'regola del 3': identifica le 3 cose pi√π importanti da fare oggi. Completale prima di tutto il resto. Aumenta la produttivit√† del 40%."
            },
            evening: {
              word: "RIFLESSIONE",
              desc: "Rifletti sulla giornata. Cosa hai imparato?",
              premium: "Prima di dormire, scrivi: 1 vittoria del giorno, 1 cosa da migliorare, 1 gratitudine. Questo rituale migliora il sonno e l'autoconsapevolezza."
            }
          },
          {
            morning: {
              word: "GRATITUDINE",
              desc: "Inizia riconoscendo ci√≤ che gi√† hai. La gratitudine moltiplica l'abbondanza.",
              premium: "Prima di alzarti dal letto, pensa a 3 cose per cui sei grato. Questa pratica mattutina aumenta l'ottimismo e riduce l'ansia del 25%."
            },
            evening: {
              word: "RESPIRO",
              desc: "Respira profondamente. Rilassa corpo e mente.",
              premium: "Pratica la respirazione 4-7-8: inspira per 4 secondi, trattieni per 7, espira per 8. Ripeti 4 volte. Attiva il parasimpatico e prepara al sonno."
            }
          },
          {
            morning: {
              word: "MOVIMENTO",
              desc: "Il corpo √® fatto per muoversi. Inizia in movimento.",
              premium: "Fai 5 minuti di stretching dinamico appena sveglio: collo, spalle, schiena, gambe. Attiva la circolazione e prepara il corpo alla giornata."
            },
            evening: {
              word: "PERDONO",
              desc: "Perdona te stesso per gli errori di oggi. Domani √® un nuovo inizio.",
              premium: "Prima di dormire, ripeti mentalmente: 'Ho fatto del mio meglio oggi. Merito riposo'. Il perdono serale riduce il cortisolo notturno."
            }
          },
          {
            morning: {
              word: "CHIAREZZA",
              desc: "Una mente chiara prende decisioni migliori.",
              premium: "Fai un 'brain dump' mattutino: scrivi tutto ci√≤ che hai in testa per 5 minuti senza filtri. Libera la mente e inizia la giornata con chiarezza."
            },
            evening: {
              word: "GRATITUDINE",
              desc: "Chiudi la giornata con riconoscenza. Il sonno sar√† pi√π sereno.",
              premium: "Tieni un diario della gratitudine sul comodino. Scrivi 3 cose positive prima di spegnere la luce. Migliora la qualit√† del sonno del 30%."
            }
          },
          {
            morning: {
              word: "PRESENZA",
              desc: "Sii qui, ora. Il momento presente √® l'unico in cui puoi davvero vivere.",
              premium: "Prima di alzarti, fai 10 respiri profondi concentrandoti solo su di essi. Questa pratica ancora nel presente e riduce ansia anticipatoria."
            },
            evening: {
              word: "RILASCIO",
              desc: "Rilascia le tensioni accumulate. Il corpo ricorda.",
              premium: "Fai uno 'body scan' di 5 minuti: porta attenzione a ogni parte del corpo e rilascia consapevolmente la tensione. Migliora qualit√† del sonno."
            }
          },
          {
            morning: {
              word: "PROPOSITO",
              desc: "Ogni giornata ha bisogno di un proposito. Qual √® il tuo oggi?",
              premium: "Scrivi il tuo intento del giorno in una frase: 'Oggi sar√≤...' (es: presente, gentile, produttivo). Rileggilo 3 volte durante il giorno."
            },
            evening: {
              word: "COMPLETAMENTO",
              desc: "Chiudi i cicli aperti. Lascia andare ci√≤ che √® finito.",
              premium: "Dedica 10 minuti al 'reset serale': riordina 1 ambiente, prepara vestiti per domani, svuota borsa/zaino. Il completamento favorisce il sonno."
            }
          },
          {
            morning: {
              word: "VITALIT√Ä",
              desc: "Risveglia la tua vitalit√†. L'energia √® dentro di te.",
              premium: "Fai 20 jumping jacks appena sveglio. L'attivazione cardiovascolare aumenta energia per le successive 4 ore del 35%."
            },
            evening: {
              word: "SERENIT√Ä",
              desc: "La serenit√† si coltiva. Inizia questa sera.",
              premium: "Ascolta musica a 432Hz per 10 minuti prima di dormire. Questa frequenza riduce battito cardiaco e favorisce rilassamento profondo."
            }
          },
          {
            morning: {
              word: "CORAGGIO",
              desc: "Il coraggio non √® assenza di paura. √à azione nonostante essa.",
              premium: "Identifica 1 cosa che ti spaventa oggi e falla per prima. Il 'frog eating' mattutino costruisce coraggio e momentum."
            },
            evening: {
              word: "ACCETTAZIONE",
              desc: "Accetta ci√≤ che √® stato oggi. Non puoi cambiare il passato.",
              premium: "Pratica il 'radical acceptance': riconosci 1 cosa che non √® andata come volevi e ripeti '√à stato cos√¨, e va bene'. Riduce rimuginio notturno."
            }
          },
          {
            morning: {
              word: "NUTRIMENTO",
              desc: "Nutri corpo e mente con ci√≤ che li fa prosperare.",
              premium: "Prepara uno smoothie verde: spinaci, banana, mela, zenzero, acqua. 3 porzioni di frutta/verdura in 1 bicchiere, energia immediata."
            },
            evening: {
              word: "PURIFICAZIONE",
              desc: "Purifica la mente dai pensieri tossici.",
              premium: "Scrivi su carta tutti i pensieri negativi, poi strappa il foglio. Questo rituale simbolico 'pulisce' la mente prima del sonno."
            }
          },
          {
            morning: {
              word: "DETERMINAZIONE",
              desc: "La determinazione trasforma l'impossibile in inevitabile.",
              premium: "Visualizza per 2 minuti il tuo obiettivo gi√† raggiunto. Vedi, senti, percepisci come se fosse reale. Il cervello non distingue: si prepara al successo."
            },
            evening: {
              word: "RESA",
              desc: "Arrenditi alla giornata. Hai fatto abbastanza.",
              premium: "Pratica la 'resa consapevole': sdraiati, respira e ripeti 'Mi arrendo a ci√≤ che √®'. Riduce resistenza e tensione muscolare."
            }
          },
          {
            morning: {
              word: "LUCE",
              desc: "Porta luce in ogni angolo della tua giornata.",
              premium: "Esponiti alla luce naturale entro 30 minuti dal risveglio per almeno 10 minuti. Regola il ritmo circadiano e migliora umore."
            },
            evening: {
              word: "OMBRA",
              desc: "L'ombra √® parte di te. Accoglila.",
              premium: "Riconosci 1 aspetto di te che non accetti. Scrivilo e ripeti: 'Questa √® una parte di me, e va bene'. L'integrazione riduce conflitto interiore."
            }
          }
        ];

        // Stato dell'app
        let isPremium = false;
        let streak = parseInt(localStorage.getItem('streak') || '1');
        let isEvening = false;
        let selectedPlan = 'monthly';

        // Controlla stato premium
        checkPremiumStatus();

        // Inizializza l'app
        function init() {
            const now = new Date();
            const hour = now.getHours();
            
            isEvening = hour >= 20 || hour < 6;
            
            const timeIndicator = document.getElementById('timeIndicator');
            if (isEvening) {
                timeIndicator.textContent = 'üåô Buonasera';
            } else {
                timeIndicator.textContent = '‚òÄÔ∏è Buongiorno';
            }
            
            const dayIndex = Math.floor(Date.now() / (1000 * 60 * 60 * 24)) % dailyContent.length;
            const today = dailyContent[dayIndex];
            const content = isEvening ? today.evening : today.morning;

            document.getElementById('dailyWord').textContent = content.word;
            document.getElementById('wordDescription').textContent = content.desc;
            document.getElementById('premiumAdvice').innerHTML = `<strong>üí° Consiglio ${isEvening ? 'della sera' : 'del mattino'}:</strong><br><br>${content.premium}`;

            document.getElementById('streak').textContent = streak;

            const lastVisit = localStorage.getItem('lastVisit');
            const today_str = new Date().toDateString();
            
            if (lastVisit !== today_str) {
                if (lastVisit && isYesterday(lastVisit)) {
                    streak++;
                } else if (lastVisit) {
                    streak = 1;
                }
                localStorage.setItem('streak', streak.toString());
                localStorage.setItem('lastVisit', today_str);
                document.getElementById('streak').textContent = streak;
            }

            if (isEvening && !isPremium) {
                document.getElementById('eveningSection').style.display = 'block';
            }
        }

        function isYesterday(dateString) {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            return dateString === yesterday.toDateString();
        }

        function showPremiumContent() {
            document.getElementById('lockedContent').style.display = 'none';
            document.getElementById('unlockBtn').style.display = 'none';
            document.getElementById('premiumContent').classList.add('active');
            document.getElementById('eveningSection').style.display = 'none';
        }

        function checkPremiumStatus() {
            isPremium = localStorage.getItem('isPremium') === 'true';
            
            if (isPremium) {
                showPremiumContent();
            }
        }

        function purchasePremium(plan) {
            if (typeof Android !== 'undefined' && Android.purchaseSubscription) {
                const productId = PLAY_PRODUCTS[plan];
                Android.purchaseSubscription(productId);
            } else {
                console.log('Test mode: simulazione acquisto', plan);
                alert('üéâ Modalit√† test: acquisto simulato!\n\nIn produzione user√† Google Play Billing.\n\nProdotto: ' + PLAY_PRODUCTS[plan]);
                
                localStorage.setItem('isPremium', 'true');
                isPremium = true;
                showPremiumContent();
                document.getElementById('premiumModal').classList.remove('active');
            }
        }

        function onPurchaseSuccess() {
            localStorage.setItem('isPremium', 'true');
            isPremium = true;
            showPremiumContent();
            document.getElementById('premiumModal').classList.remove('active');
            alert('‚ú® Benvenuto nel Premium! Riceverai 2 momenti quotidiani: mattino (8:00) e sera (20:00).');
        }

        function onPurchaseError(error) {
            alert('‚ùå Acquisto non completato. Riprova.');
            console.error('Purchase error:', error);
        }

        // Event listeners
        document.getElementById('unlockBtn').addEventListener('click', () => {
            document.getElementById('premiumModal').classList.add('active');
        });

        document.getElementById('closeModal').addEventListener('click', () => {
            document.getElementById('premiumModal').classList.remove('active');
        });

        document.getElementById('monthlyOption').addEventListener('click', () => {
            selectedPlan = 'monthly';
            document.getElementById('monthlyOption').classList.add('selected');
            document.getElementById('yearlyOption').classList.remove('selected');
        });

        document.getElementById('yearlyOption').addEventListener('click', () => {
            selectedPlan = 'yearly';
            document.getElementById('yearlyOption').classList.add('selected');
            document.getElementById('monthlyOption').classList.remove('selected');
        });

        document.getElementById('subscribeBtn').addEventListener('click', () => {
            purchasePremium(selectedPlan);
        });

        document.getElementById('shareBtn').addEventListener('click', () => {
            const word = document.getElementById('dailyWord').textContent;
            const timeOfDay = isEvening ? 'sera' : 'mattino';
            const text = `La mia parola di ${timeOfDay} √®: ${word}\n\nScopri la tua su OneWordBeam ‚ú®`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'OneWordBeam - Daily Inspiration',
                    text: text
                });
            } else {
                navigator.clipboard.writeText(text);
                alert('üìã Testo copiato! Condividilo dove preferisci.');
            }
        });

        init();
    </script>
</body>
</html>
